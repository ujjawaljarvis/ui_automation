{% extends 'base.html' %}

{% block title %}XPath Capture Instructions - TestAutomator{% endblock %}

{% block content %}
<div class="bg-white shadow rounded-lg p-6">
    <div class="flex items-center mb-6">
        <a href="{% url 'xpath_capture_home' %}" class="mr-4">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-gray-500" viewBox="0 0 20 20" fill="currentColor">
                <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd" />
            </svg>
        </a>
        <h1 class="text-2xl font-bold text-gray-900">XPath Capture Instructions</h1>
    </div>

    <!-- Target Info -->
    <div class="mb-6 p-4 bg-gray-50 rounded-md">
        <div class="flex items-center">
            <div class="flex-shrink-0">
                <svg class="h-5 w-5 text-gray-400" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 00-1.414 1.414 4 4 0 005.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 00-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </div>
            <div class="ml-3">
                <h3 class="text-sm font-medium text-gray-900">Target URL</h3>
                <p class="text-sm text-gray-500">{{ url }}</p>
            </div>
        </div>
        {% if project %}
        <div class="flex items-center mt-3">
            <div class="flex-shrink-0">
                <svg class="h-5 w-5 text-gray-400" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                    <path fill-rule="evenodd" d="M2 6a2 2 0 012-2h5l2 2h5a2 2 0 012 2v6a2 2 0 01-2 2H4a2 2 0 01-2-2V6z" clip-rule="evenodd" />
                </svg>
            </div>
            <div class="ml-3">
                <h3 class="text-sm font-medium text-gray-900">Project</h3>
                <p class="text-sm text-gray-500">{{ project.name }}</p>
            </div>
        </div>
        {% endif %}
    </div>

    <!-- Instructions -->
    <div class="mb-8">
        <h2 class="text-lg font-medium text-gray-900 mb-4">How to Capture XPaths</h2>
        
        <div class="space-y-4">
            <div class="flex">
                <div class="flex-shrink-0">
                    <div class="flex items-center justify-center h-8 w-8 rounded-full bg-blue-500 text-white">
                        1
                    </div>
                </div>
                <div class="ml-4">
                    <h3 class="text-md font-medium text-gray-900">Hover Over Elements</h3>
                    <p class="mt-1 text-sm text-gray-500">
                        Move your mouse over any element on the page. Elements will be highlighted as you hover over them.
                    </p>
                </div>
            </div>
            
            <div class="flex">
                <div class="flex-shrink-0">
                    <div class="flex items-center justify-center h-8 w-8 rounded-full bg-blue-500 text-white">
                        2
                    </div>
                </div>
                <div class="ml-4">
                    <h3 class="text-md font-medium text-gray-900">Automatic Capture</h3>
                    <p class="mt-1 text-sm text-gray-500">
                        Hold your mouse over an element for 0.5 seconds to automatically capture its XPath and other details.
                    </p>
                </div>
            </div>
            
            <div class="flex">
                <div class="flex-shrink-0">
                    <div class="flex items-center justify-center h-8 w-8 rounded-full bg-blue-500 text-white">
                        3
                    </div>
                </div>
                <div class="ml-4">
                    <h3 class="text-md font-medium text-gray-900">Stop When Done</h3>
                    <p class="mt-1 text-sm text-gray-500">
                        When you've captured all the elements you need, return to the capture page and click the "Stop Capture" button.
                    </p>
                </div>
            </div>
            
            <div class="flex">
                <div class="flex-shrink-0">
                    <div class="flex items-center justify-center h-8 w-8 rounded-full bg-red-500 text-white">
                        !
                    </div>
                </div>
                <div class="ml-4">
                    <h3 class="text-md font-medium text-gray-900">Important Note</h3>
                    <p class="mt-1 text-sm text-gray-500">
                        If you close the browser window, you must still click "View Results" on the capture page to see your captured elements.
                    </p>
                </div>
            </div>
        </div>
    </div>

    <!-- Countdown -->
    <div class="mb-8 text-center">
        <p class="text-sm text-gray-500">Capture will start in:</p>
        <div id="countdown" class="text-4xl font-bold text-blue-600">{{ countdown }}</div>
        <div class="mt-2 h-2 bg-gray-200 rounded-full">
            <div id="progress-bar" class="h-2 bg-blue-600 rounded-full" style="width: 100%;"></div>
        </div>
    </div>

    <!-- Start Now Button -->
    <div class="flex justify-center">
        <a href="{% url 'start_xpath_capture' %}" class="inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
            Start Now
        </a>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
    // Countdown timer
    let countdown = {{ countdown }};
    const countdownElement = document.getElementById('countdown');
    const progressBar = document.getElementById('progress-bar');
    const totalTime = {{ countdown }};
    
    const timer = setInterval(() => {
        countdown--;
        countdownElement.textContent = countdown;
        
        // Update progress bar
        const percentage = (countdown / totalTime) * 100;
        progressBar.style.width = percentage + '%';
        
        if (countdown <= 0) {
            clearInterval(timer);
            window.location.href = "{% url 'start_xpath_capture' %}";
        }
    }, 1000);
</script>
{% endblock %}